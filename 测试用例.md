## 测试用例

### 新建分区表
1. 新建普通的range分区表，可成功创建

    输入:

        CREATE TABLE employees(
            id INT NOT NULL,
            fname VARCHAR(30),
            lname VARCHAR(30),
            hired DATE NOT NULL DEFAULT '1970-01-01',
            separated DATE NOT NULL DEFAULT '9999-12-31',
            job_code INT NOT NULL,
            store_id INT NOT NULL
        ) 
        PARTITION BY RANGE (store_id) (
            PARTITION p0 VALUES LESS THAN (6),
            PARTITION p1 VALUES LESS THAN (11),
            PARTITION p2 VALUES LESS THAN (16),
            PARTITION p3 VALUES LESS THAN (21)
        );
    输出:

        Query OK, 0 rows affected (0.07 sec)

2. 新建分区表，包含MAXVALUE，创建成功  

    输入:

        CREATE TABLE employees1 (
            id INT NOT NULL,
            fname VARCHAR(30),
            lname VARCHAR(30),
            hired DATE NOT NULL DEFAULT '1970-01-01',
            separated DATE NOT NULL DEFAULT '9999-12-31',
            job_code INT NOT NULL,
            store_id INT NOT NULL
            )

        PARTITION BY RANGE (store_id) (
            PARTITION p0 VALUES LESS THAN (6),
            PARTITION p1 VALUES LESS THAN (11),
            PARTITION p2 VALUES LESS THAN (16),
            PARTITION p3 VALUES LESS THAN MAXVALUE 
        );
    输出:

        Query OK, 0 rows affected (0.10 sec)

3. 新建分区表，分区键在表的唯一键中，创建成功
    
    输入:

        CREATE TABLE t1 (
            col1 INT NOT NULL PRIMARY KEY ,
            col2 DATE NOT NULL,
            col3 INT NOT NULL,
            col4 INT NOT NULL
            )
        PARTITION BY RANGE(col1) (
            PARTITION p0 VALUES LESS THAN (10)
        )
    输出:

        Query OK, 0 rows affected (0.08 sec)

4. 新建分区表，分区键不在表的唯一键中;创建失败:提示报错信息

    输入:

         CREATE TABLE t2 (
            col1 INT NOT NULL,
            col2 DATE NOT NULL,
            col3 INT NOT NULL,
            col4 INT NOT NULL,
            UNIQUE KEY (col1,col2)
        )
        PARTITION BY RANGE(col3) (
            PARTITION p0 VALUES LESS THAN (10)
        );

    输出:

        ERROR 1503 (HY000): A UNIQUE INDEX must include all columns in the table's partitioning function

5. 新建分区表，分区键不在表中;创建失败:提示报错信息
        输入:

        CREATE TABLE t3 (
            col1 INT NOT NULL ,
            col2 DATE NOT NULL,
            col3 INT NOT NULL,
            col4 INT NOT NULL
            )  
        PARTITION BY RANGE(col5) (
            PARTITION p0 VALUES LESS THAN (10)
        );

    输出:

        ERROR 1492 (HY000): For RANGE partitions each partition must be defined
6. 新建分区表，分区列的值不是INT类型;创建失败，提示报错
    输入

        CREATE TABLE qq_member (
                    member_id int(11) NOT NULL,
                    grade varchar(10) NOT NULL,
                    start_time date NOT NULL,
                    end_time date NOT NULL,
                    PRIMARY KEY (member_id)
            )
        PARTITION BY RANGE (grade) (
            PARTITION p0 VALUES LESS THAN (10)
            );
    输出:

        ERROR 1659 (HY000): Field '`grade`' is of a not allowed type for this type of partitioning
7. 新建分区表，创建分区不连续的分区表; 创建失败。提示报错信息
    
    输入:

        CREATE TABLE score(
            student_id INT NOT NULL,
            name VARCHAR(10) NOT NULL,
            score TINYINT,
            UNIQUE KEY(student_id)
            )
            PARTITION BY RANGE(socre) (
            PARTITION p0 VALUES LESS THAN (60),
            PARTITION p1 VALUES LESS THAN (100),
            PARTITION p2 VALUES LESS THAN (80),
            PARTITION p3 VALUES LESS THAN (90)
        );
    输出:

        ERROR 1493 (HY000): VALUES LESS THAN value must be strictly increasing for each partitio   
6. 新建分区表，创建重复分区的表;创建失败,提示报错信息
    输入:

        CREATE TABLE score1(
            student_id INT NOT NULL,
            name VARCHAR(10) NOT NULL,
            score TINYINT,
            UNIQUE KEY(student_id)
            )
            PARTITION BY RANGE(socre) (
            PARTITION p1 VALUES LESS THAN (60),
            PARTITION p1 VALUES LESS THAN (100),
            PARTITION p2 VALUES LESS THAN (80),
            PARTITION p3 VALUES LESS THAN (90)
        );
    输出:
        
        ERROR 1517 (HY000): Duplicate partition name p1
### 管理分区表
#### 查看分区信息
1. 查看employees表的分区信息;可以正常显示employees表的分区信息  
    输入:
        
        SELECT partition_name part,partition_expression expr,partition_description descr,table_rows FROM information_schema.partitions WHERE table_schema = SCHEMA() AND TABLE_NAME='employees';
    输出:

        +------+------------+-------+------------+
        | part | expr       | descr | table_rows |
        +------+------------+-------+------------+
        | p0   | `store_id` | 6     |          0 |
        | p1   | `store_id` | 11    |          0 |
        | p2   | `store_id` | 16    |          0 |
        | p3   | `store_id` | 23    |          0 |
        +------+------------+-------+------------+
#### 添加分区
1. 给employees分区表添加p4分区;添加成功
    
    输入:

        ALTER TABLE `employees` ADD PARTITION (partition p4 VALUES LESS THAN (40));

    输出&检查分区:

        +------+------------+-------+------------+
        | part | expr       | descr | table_rows |
        +------+------------+-------+------------+
        | p0   | `store_id` | 6     |          0 |
        | p1   | `store_id` | 11    |          0 |
        | p2   | `store_id` | 16    |          0 |
        | p3   | `store_id` | 23    |          0 |
        | p4   | `store_id` | 40    |          0 |
        +------+------------+-------+------------+
2. 给普通表member表添加分区;添加失败并报错  
   member表

        CREATE TABLE `member` (
            `member_id` int(11) NOT NULL,
            `grade` varchar(10) NOT NULL,
            `start_time` date NOT NULL,
            `end_time` date NOT NULL,
            PRIMARY KEY (`member_id`)
        )
    输入:

        ALTER TABLE `member` ADD PARTITION (partition p0 VALUES LESS THAN (10));  

    输出:

        ERROR 1505 (HY000): Partition management on a not partitioned table is not possible 

3. 添加分区，分区值小于上一个分区的值，提示报错信息
#### 删除分区
1. 删除employees表删除p0分区;删除成功  
    输入:

        ALTER TABLE `employees` DROP PARTITION p0;

    输出:

        +------+------------+-------+------------+
        | part | expr       | descr | table_rows |
        +------+------------+-------+------------+
        | p1   | `store_id` | 11    |          0 |
        | p2   | `store_id` | 16    |          0 |
        | p3   | `store_id` | 23    |          0 |
        | p4   | `store_id` | 40    |          0 |
        +------+------------+-------+------------+

5. 重新定义range分区表，修改分区键的分区值;不支持
    输入:

        ALTER TABLE t1  PARTITION BY RANGE(col1) (
        PARTITION p0 VALUES LESS THAN (60),
        PARTITION p1 VALUES LESS THAN (100)
        );
    输出:

        ERROR 1105 (HY000): alter table partition is unsupported
    
#### 分区裁剪

#### 分区表的数据操作

